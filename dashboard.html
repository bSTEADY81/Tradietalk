<!--
  dashboard.html – User dashboard for TradieTalk AI

  This page allows authenticated users to create and manage quotes.  It
  demonstrates voice recognition with the Web Speech API, dynamic item
  entry with real-time calculations, PDF generation via jsPDF, and
  customizable speech synthesis for reading back quotes.  Quotes are
  temporarily stored in the browser’s localStorage.

  Note: For security reasons browsers may restrict speech recognition
  behind https and with user gestures.  Testing locally via file:/// may
  require enabling experimental flags or hosting via a local server.
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard – TradieTalk AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- jsPDF for PDF generation -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  </head>
  <body class="min-h-screen bg-gray-50">
    <!-- Navbar -->
    <header class="bg-white shadow py-4">
      <div class="max-w-7xl mx-auto px-4 flex items-center justify-between">
        <a href="index.html" class="text-xl font-bold text-blue-600">TradieTalk AI</a>
        <nav class="space-x-6 text-sm">
          <a href="#" id="logoutLink" class="hover:text-blue-600">Log Out</a>
        </nav>
      </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
      <h1 class="text-2xl font-bold mb-6">Create a New Quote</h1>
      <!-- Client Information -->
      <div class="bg-white p-6 rounded shadow mb-6">
        <h2 class="text-lg font-semibold mb-4">Client Details</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="clientName" class="block text-sm font-medium text-gray-700">Client Name</label>
            <input id="clientName" type="text" class="mt-1 w-full border border-gray-300 rounded px-3 py-2" />
          </div>
          <div>
            <label for="clientEmail" class="block text-sm font-medium text-gray-700">Client Email</label>
            <input id="clientEmail" type="email" class="mt-1 w-full border border-gray-300 rounded px-3 py-2" />
          </div>
          <div class="sm:col-span-2">
            <label for="jobDescription" class="block text-sm font-medium text-gray-700">Job Description</label>
            <textarea id="jobDescription" rows="3" class="mt-1 w-full border border-gray-300 rounded px-3 py-2"></textarea>
          </div>
          <div class="sm:col-span-2">
            <button id="startVoiceBtn" type="button" class="mt-2 inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 1.5a3 3 0 013 3v6a3 3 0 11-6 0v-6a3 3 0 013-3zm6.5 9a.5.5 0 00-1 0 7.5 7.5 0 01-6 7.35V21h2a.5.5 0 110 1h-6a.5.5 0 110-1h2v-3.15A7.5 7.5 0 016.5 10.5a.5.5 0 00-1 0 8.5 8.5 0 0014 6.53V18a.5.5 0 001 0v-1.97A8.5 8.5 0 0018.5 10.5z" />
              </svg>
              Speak Job Details
            </button>
            <span id="voiceStatus" class="ml-3 text-sm text-gray-600"></span>
          </div>
        </div>
      </div>

      <!-- Items Section -->
      <div class="bg-white p-6 rounded shadow mb-6">
        <h2 class="text-lg font-semibold mb-4">Line Items</h2>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm text-left" id="itemsTable">
            <thead>
              <tr class="bg-gray-100">
                <th class="px-3 py-2">Description</th>
                <th class="px-3 py-2">Quantity</th>
                <th class="px-3 py-2">Unit Price ($)</th>
                <th class="px-3 py-2">Total ($)</th>
                <th class="px-3 py-2"></th>
              </tr>
            </thead>
            <tbody>
              <!-- Item rows will be inserted here -->
            </tbody>
          </table>
        </div>
        <button id="addItemBtn" type="button" class="mt-4 px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300">Add Item</button>
      </div>

      <!-- Quote Summary -->
      <div class="bg-white p-6 rounded shadow mb-6">
        <h2 class="text-lg font-semibold mb-4">Quote Summary</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="tradeType" class="block text-sm font-medium text-gray-700">Trade Type</label>
            <select id="tradeType" class="mt-1 w-full border border-gray-300 rounded px-3 py-2">
              <option value="general" selected>General</option>
              <option value="concrete">Concrete</option>
              <option value="tiling">Tiling</option>
              <option value="painting">Painting</option>
              <option value="landscaping">Landscaping</option>
              <option value="building">Building</option>
              <option value="plumbing">Plumbing</option>
              <option value="electrical">Electrical</option>
              <option value="carpentry">Carpentry</option>
              <option value="roofing">Roofing</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div>
            <label for="margin" class="block text-sm font-medium text-gray-700">Markup / Margin (%)</label>
            <input id="margin" type="number" value="20" min="0" step="1" class="mt-1 w-full border border-gray-300 rounded px-3 py-2" />
          </div>
          <div>
            <label for="voiceSelect" class="block text-sm font-medium text-gray-700">Voice (for read aloud)</label>
            <select id="voiceSelect" class="mt-1 w-full border border-gray-300 rounded px-3 py-2"></select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Subtotal ($)</label>
            <p id="subtotalDisplay" class="mt-1 p-2 bg-gray-100 rounded">0.00</p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">GST (10%)</label>
            <p id="gstDisplay" class="mt-1 p-2 bg-gray-100 rounded">0.00</p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Total ($)</label>
            <p id="totalDisplay" class="mt-1 p-2 bg-gray-100 rounded font-semibold">0.00</p>
          </div>
        </div>
        <button id="calculateBtn" type="button" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Calculate Quote</button>
      </div>

      <!-- Actions -->
      <div class="flex flex-col sm:flex-row gap-4 mb-20">
        <button id="generatePdfBtn" type="button" class="flex-1 px-4 py-3 bg-green-600 text-white rounded hover:bg-green-700">Generate PDF</button>
        <button id="readQuoteBtn" type="button" class="flex-1 px-4 py-3 bg-indigo-600 text-white rounded hover:bg-indigo-700">Read Quote Aloud</button>
        <button id="sendEmailBtn" type="button" class="flex-1 px-4 py-3 bg-purple-600 text-white rounded hover:bg-purple-700">Send via Email</button>
      </div>
    </main>

    <script src="script.js"></script>
    <script>
      // Initialise the dashboard when DOM is ready
      document.addEventListener('DOMContentLoaded', () => {
        initDashboard();
      });
    </script>
  </body>
</html>